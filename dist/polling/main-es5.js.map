{"version":3,"sources":["./$_lazy_route_resource lazy namespace object","./src/app/app.component.html","./src/app/tester/tester.component.html","./src/app/app.component.css","./src/app/app.component.ts","./src/app/app.module.ts","./src/app/interval.service.ts","./src/app/tester/tester.component.css","./src/app/tester/tester.component.ts","./src/environments/environment.ts","./src/main.ts"],"names":[],"mappings":"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","file":"main-es5.js","sourcesContent":["function webpackEmptyAsyncContext(req) {\n\t// Here Promise.resolve().then() is used instead of new Promise() to prevent\n\t// uncaught exception popping up in devtools\n\treturn Promise.resolve().then(function() {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t});\n}\nwebpackEmptyAsyncContext.keys = function() { return []; };\nwebpackEmptyAsyncContext.resolve = webpackEmptyAsyncContext;\nmodule.exports = webpackEmptyAsyncContext;\nwebpackEmptyAsyncContext.id = \"./$$_lazy_route_resource lazy recursive\";","module.exports = \"<!--The content below is only a placeholder and can be replaced.-->\\n<div style=\\\"text-align:center\\\">\\n  <h1>\\n    Welcome to {{ title }}!\\n  </h1>\\n  <img width=\\\"300\\\" alt=\\\"Angular Logo\\\" src=\\\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyNTAgMjUwIj4KICAgIDxwYXRoIGZpbGw9IiNERDAwMzEiIGQ9Ik0xMjUgMzBMMzEuOSA2My4ybDE0LjIgMTIzLjFMMTI1IDIzMGw3OC45LTQzLjcgMTQuMi0xMjMuMXoiIC8+CiAgICA8cGF0aCBmaWxsPSIjQzMwMDJGIiBkPSJNMTI1IDMwdjIyLjItLjFWMjMwbDc4LjktNDMuNyAxNC4yLTEyMy4xTDEyNSAzMHoiIC8+CiAgICA8cGF0aCAgZmlsbD0iI0ZGRkZGRiIgZD0iTTEyNSA1Mi4xTDY2LjggMTgyLjZoMjEuN2wxMS43LTI5LjJoNDkuNGwxMS43IDI5LjJIMTgzTDEyNSA1Mi4xem0xNyA4My4zaC0zNGwxNy00MC45IDE3IDQwLjl6IiAvPgogIDwvc3ZnPg==\\\">\\n</div>\\n<h2>Here are some links to help you start: </h2>\\n<ul>\\n  <li>\\n    <h2><a target=\\\"_blank\\\" rel=\\\"noopener\\\" href=\\\"https://angular.io/tutorial\\\">Tour of Heroes</a></h2>\\n  </li>\\n  <li>\\n    <h2><a target=\\\"_blank\\\" rel=\\\"noopener\\\" href=\\\"https://angular.io/cli\\\">CLI Documentation</a></h2>\\n  </li>\\n  <li>\\n    <h2><a target=\\\"_blank\\\" rel=\\\"noopener\\\" href=\\\"https://blog.angular.io/\\\">Angular blog</a></h2>\\n  </li>\\n</ul>\\n\\n<div>\\n<button (click)=\\\"showTest = !showTest\\\">Toggle Test</button>\\n</div>\\n\\n<app-tester *ngIf=\\\"showTest\\\"></app-tester>\\n\\n\"","module.exports = \"<button (click)=\\\"getData('abc')\\\">get data 'abc'</button>\\n<button (click)=\\\"cancel()\\\">Cancel All</button>\\n<button (click)=\\\"cancel('abc')\\\">Cancel ABC</button>\\n<button (click)=\\\"cancel('zzz')\\\">Cancel ZZZ</button>\\n<button (click)=\\\"start('abc')\\\">start ABC</button>\\n<button (click)=\\\"start('zzz')\\\">start ZZZ</button>\\n\"","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2FwcC5jb21wb25lbnQuY3NzIn0= */\"","import { Component, OnInit } from '@angular/core';\n\n@Component({\n  selector: 'app-root',\n  templateUrl: './app.component.html',\n  styleUrls: ['./app.component.css']\n})\nexport class AppComponent implements OnInit {\n  title = 'Polling POC';\n  showTest = true;\n\n  constructor() {\n  }\n\n  ngOnInit(): void {\n  }\n\n}\n","import { BrowserModule } from '@angular/platform-browser';\nimport { NgModule } from '@angular/core';\n\nimport { AppComponent } from './app.component';\nimport { TesterComponent } from './tester/tester.component';\n\n@NgModule({\n  declarations: [\n    AppComponent,\n    TesterComponent\n  ],\n  imports: [\n    BrowserModule\n  ],\n  providers: [],\n  bootstrap: [AppComponent]\n})\nexport class AppModule { }\n","import { Injectable, OnDestroy } from '@angular/core';\nimport { interval, Observable, of, Subject } from 'rxjs';\nimport {delay, first, switchMap, takeUntil, tap} from 'rxjs/operators';\n\nexport interface IntervalMapItem {\n  apiCall: Observable<any>;\n  pause: Subject<string>;\n  interval: Observable<any>;\n}\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class IntervalService implements OnDestroy {\n  intervalMap = new Map<string, IntervalMapItem>();\n  private SECONDS = 30;\n  private destroy$ = new Subject();\n\n  constructor() {\n  }\n\n  startInterval(key: string) {\n    if (!this.intervalMap.has(key)) {\n      this.addScheduledInterval(key);\n    }\n    this.intervalMap.get(key).interval = this.createSchedule(key);\n    this.intervalMap.get(key).interval.subscribe( () => this.createSchedule(key));\n  }\n\n  addScheduledInterval(key: string) {\n    const intervalMapItem = {\n      apiCall: of(key).pipe(delay(1000), tap(val => console.log(val))),\n      pause: new Subject<string>(),\n      interval: new Observable<any>()\n    };\n    this.intervalMap.set(key, intervalMapItem);\n  }\n\n  getData(key: string) {\n    const intervalMapItem = this.intervalMap.get(key);\n    intervalMapItem.pause.next(Date.now().toString());\n    intervalMapItem.apiCall\n      .pipe(\n        tap((val) => console.log('from manual call')),\n        switchMap(() => intervalMapItem.interval),\n        ).\n      subscribe(\n      () => this.createSchedule(key)\n      );\n  }\n\n  cancelInterval(key: string) {\n    if (!!key) {\n      this.intervalMap.get(key).pause.next(Date.now().toString());\n    }\n  }\n\n  cancelAll() {\n    this.destroy$.next();\n  }\n\n  private createSchedule(key: string = ''): Observable<number> {\n    return this.setInterval().pipe(\n      switchMap( () => {\n        console.log('wait for it...');\n        return key ? this.intervalMap.get(key).apiCall : of(null);\n      }),\n      tap( () => console.log('from interval')),\n      takeUntil(this.intervalMap.get(key).pause),\n      switchMap( () => this.createSchedule(key))\n    );\n  }\n\n  private setInterval(): Observable<number> {\n    return interval(this.SECONDS * 1000).pipe(\n      first(),\n      takeUntil(this.destroy$)\n    );\n  }\n\n  ngOnDestroy(): void {\n    this.destroy$.next();\n    this.destroy$.unsubscribe();\n    console.log('destroy!');\n  }\n}\n","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL3Rlc3Rlci90ZXN0ZXIuY29tcG9uZW50LmNzcyJ9 */\"","import { Component, OnInit, OnDestroy } from '@angular/core';\nimport {IntervalService} from '../interval.service';\n\n@Component({\n  selector: 'app-tester',\n  templateUrl: './tester.component.html',\n  styleUrls: ['./tester.component.css'],\n  providers: [IntervalService]\n})\nexport class TesterComponent implements OnInit, OnDestroy {\n\n  constructor(private intervalService: IntervalService) {\n  }\n\n  ngOnInit(): void {\n    this.intervalService.startInterval('abc');\n    setTimeout(\n      () => this.intervalService.startInterval('zzz'), 3000\n    );\n  }\n\n  getData(key: string) {\n    this.intervalService.getData(key);\n  }\n\n  ngOnDestroy(): void {\n    console.log('destroy!');\n  }\n\n  cancel(key: string = '') {\n    if (!!key) {\n      this.intervalService.cancelInterval(key);\n    } else {\n      this.intervalService.cancelAll();\n    }\n  }\n\n  start(key) {\n    if (key) {\n      this.intervalService.startInterval(key);\n    }\n  }\n}\n","// This file can be replaced during build by using the `fileReplacements` array.\n// `ng build --prod` replaces `environment.ts` with `environment.prod.ts`.\n// The list of file replacements can be found in `angular.json`.\n\nexport const environment = {\n  production: false\n};\n\n/*\n * For easier debugging in development mode, you can import the following file\n * to ignore zone related error stack frames such as `zone.run`, `zoneDelegate.invokeTask`.\n *\n * This import should be commented out in production mode because it will have a negative impact\n * on performance if an error is thrown.\n */\n// import 'zone.js/dist/zone-error';  // Included with Angular CLI.\n","import { enableProdMode } from '@angular/core';\nimport { platformBrowserDynamic } from '@angular/platform-browser-dynamic';\n\nimport { AppModule } from './app/app.module';\nimport { environment } from './environments/environment';\n\nif (environment.production) {\n  enableProdMode();\n}\n\nplatformBrowserDynamic().bootstrapModule(AppModule)\n  .catch(err => console.error(err));\n"],"sourceRoot":"webpack:///"}